{{ define "main" }}
<article class="post-single">
  <header class="post-header">
    <div class="post-meta">
      {{ with .Params.type }}<span class="post-type {{ . | urlize }}">{{ . }}</span>{{ end }}
      <time>{{ .Date.Format "January 2, 2006" }}</time>
    </div>
    <h1>{{ .Title }}</h1>
    {{ with .Params.description }}<p class="post-description">{{ . }}</p>{{ end }}
  </header>

  <div class="post-content">
    {{ .Content | replaceRE `(?s)<h2[^>]*>Related</h2>.*` "" | safeHTML }}
  </div>

  {{ with .Params.tags }}
  <div class="post-tags" style="margin-top: 2.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-subtle);">
    {{ range . }}<a href="/tags/{{ . | urlize }}/">#{{ . }}</a>{{ end }}
  </div>
  {{ end }}

  <nav class="post-nav">
    {{ with .PrevInSection }}
    <a href="{{ .Permalink }}" class="post-nav-link prev">
      <span class="post-nav-label">← Previous</span>
      <span class="post-nav-title">{{ .Title }}</span>
    </a>
    {{ end }}
    {{ with .NextInSection }}
    <a href="{{ .Permalink }}" class="post-nav-link next">
      <span class="post-nav-label">Next →</span>
      <span class="post-nav-title">{{ .Title }}</span>
    </a>
    {{ end }}
  </nav>

  <div style="margin-top: 2rem; text-align: center;">
    <a href="/" style="color: var(--text-muted); font-size: 0.85rem;">← Back to the stream</a>
  </div>
</article>
{{ end }}
